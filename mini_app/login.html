<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Helper Bot - –í—Ö–æ–¥">
    <meta name="theme-color" content="#667eea">
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="format-detection" content="telephone=no">
    <meta name="HandheldFriendly" content="true">
    <title>Helper Bot - –í—Ö–æ–¥</title>
    <link rel="stylesheet" href="login.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- üîí –¢–µ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—Ö–æ–¥–∞ -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="login-header">
                <div class="login-icon">üîí</div>
                <h1 class="login-title">Helper Bot</h1>
                <p class="login-subtitle">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞</p>
            </div>

            <!-- –ü–æ–ª—è –¥–ª—è –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è -->
            <div class="login-fields" id="loginFields">
                <div class="login-field" data-index="0"></div>
                <div class="login-field" data-index="1"></div>
                <div class="login-field" data-index="2"></div>
                <div class="login-field" data-index="3"></div>
                <div class="login-field" data-index="4"></div>
                <div class="login-field" data-index="5"></div>
            </div>

            <!-- –¢–æ—á–∫–∏ –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ -->
            <div class="login-dots" id="loginDots">
                <div class="login-dot" data-index="0"></div>
                <div class="login-dot" data-index="1"></div>
                <div class="login-dot" data-index="2"></div>
                <div class="login-dot" data-index="3"></div>
                <div class="login-dot" data-index="4"></div>
                <div class="login-dot" data-index="5"></div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="login-actions">
                <button class="login-btn clear" id="clearBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="login-btn enter" id="enterBtn">–í–æ–π—Ç–∏</button>
            </div>

            <!-- –¶–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ -->
            <div class="login-keypad" id="loginKeypad">
                <button class="login-key" data-digit="1">1</button>
                <button class="login-key" data-digit="2">2</button>
                <button class="login-key" data-digit="3">3</button>
                <button class="login-key" data-digit="4">4</button>
                <button class="login-key" data-digit="5">5</button>
                <button class="login-key" data-digit="6">6</button>
                <button class="login-key" data-digit="7">7</button>
                <button class="login-key" data-digit="8">8</button>
                <button class="login-key" data-digit="9">9</button>
                <button class="login-key zero" data-digit="0">0</button>
                <button class="login-key backspace" id="backspaceBtn">‚å´</button>
            </div>
        </div>
    </div>

    <script>
        // üîí –°–∏—Å—Ç–µ–º–∞ –≤—Ö–æ–¥–∞
        class LoginSystem {
            constructor() {
                this.password = '407264'; // –ü–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                this.currentInput = '';
                this.currentIndex = 0;
                this.maxLength = 6;
                
                this.init();
            }

            init() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                if (this.checkAuth()) {
                    this.redirectToMain();
                    return;
                }

                this.bindEvents();
                this.updateDisplay();
                this.focusCurrentField();
            }

            checkAuth() {
                const isAuthenticated = localStorage.getItem('isAuthenticated');
                const authTimestamp = localStorage.getItem('authTimestamp');
                
                if (isAuthenticated && authTimestamp) {
                    const now = Date.now();
                    const authTime = parseInt(authTimestamp);
                    const hoursSinceAuth = (now - authTime) / (1000 * 60 * 60);
                    
                    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ 24 —á–∞—Å–∞
                    if (hoursSinceAuth < 24) {
                        return true;
                    } else {
                        // –û—á–∏—â–∞–µ–º —É—Å—Ç–∞—Ä–µ–≤—à—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                        localStorage.removeItem('isAuthenticated');
                        localStorage.removeItem('authTimestamp');
                    }
                }
                
                return false;
            }

            redirectToMain() {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                window.location.href = 'index.html';
            }

            bindEvents() {
                // –¶–∏—Ñ—Ä–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
                document.querySelectorAll('.login-key[data-digit]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const digit = e.target.dataset.digit;
                        this.addDigit(digit);
                    });
                });

                // –ö–Ω–æ–ø–∫–∞ Backspace
                const backspaceBtn = document.getElementById('backspaceBtn');
                if (backspaceBtn) {
                    backspaceBtn.addEventListener('click', () => {
                        this.removeDigit();
                    });
                }

                // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∏—Ç—å
                const clearBtn = document.getElementById('clearBtn');
                if (clearBtn) {
                    clearBtn.addEventListener('click', () => {
                        this.clearAll();
                    });
                }

                // –ö–Ω–æ–ø–∫–∞ –≤–æ–π—Ç–∏
                const enterBtn = document.getElementById('enterBtn');
                if (enterBtn) {
                    enterBtn.addEventListener('click', () => {
                        this.checkPassword();
                    });
                }

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
                document.addEventListener('keydown', (e) => {
                    this.handleKeydown(e);
                });

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å—Ç–∞–≤–∫–∏ –∏–∑ –±—É—Ñ–µ—Ä–∞
                document.addEventListener('paste', (e) => {
                    this.handlePaste(e);
                });
            }

            addDigit(digit) {
                if (this.currentInput.length < this.maxLength) {
                    this.currentInput += digit;
                    this.currentIndex = this.currentInput.length;
                    this.updateDisplay();
                    this.focusCurrentField();
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ–ª—é
                    if (this.currentInput.length < this.maxLength) {
                        setTimeout(() => {
                            this.focusCurrentField();
                        }, 100);
                    }
                }
            }

            removeDigit() {
                if (this.currentInput.length > 0) {
                    this.currentInput = this.currentInput.slice(0, -1);
                    this.currentIndex = this.currentInput.length;
                    this.updateDisplay();
                    this.focusCurrentField();
                }
            }

            clearAll() {
                this.currentInput = '';
                this.currentIndex = 0;
                this.updateDisplay();
                this.focusCurrentField();
                this.clearError();
            }

            checkPassword() {
                if (this.currentInput === this.password) {
                    this.showSuccess();
                } else {
                    this.showError();
                }
            }

            showSuccess() {
                // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
                document.querySelectorAll('.login-field').forEach(field => {
                    field.classList.add('filled');
                });

                setTimeout(() => {
                    this.authenticate();
                }, 800);
            }

            showError() {
                // –ê–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
                document.querySelectorAll('.login-field').forEach(field => {
                    field.classList.add('error');
                });

                setTimeout(() => {
                    this.clearError();
                }, 2000);
            }

            clearError() {
                document.querySelectorAll('.login-field').forEach(field => {
                    field.classList.remove('error');
                });
            }

            authenticate() {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                localStorage.setItem('isAuthenticated', 'true');
                localStorage.setItem('authTimestamp', Date.now().toString());

                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                this.redirectToMain();
            }

            updateDisplay() {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
                const fields = document.querySelectorAll('.login-field');
                fields.forEach((field, index) => {
                    const digit = this.currentInput[index] || '';
                    field.textContent = digit;
                    
                    if (digit) {
                        field.classList.add('filled');
                    } else {
                        field.classList.remove('filled');
                    }
                });

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ—á–∫–∏
                const dots = document.querySelectorAll('.login-dot');
                dots.forEach((dot, index) => {
                    if (index < this.currentInput.length) {
                        dot.classList.add('filled');
                    } else {
                        dot.classList.remove('filled');
                    }
                });
            }

            focusCurrentField() {
                // –£–±–∏—Ä–∞–µ–º —Ñ–æ–∫—É—Å —Å–æ –≤—Å–µ—Ö –ø–æ–ª–µ–π
                document.querySelectorAll('.login-field').forEach(field => {
                    field.classList.remove('focus');
                });

                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–µ
                if (this.currentIndex < this.maxLength) {
                    const currentField = document.querySelector(`[data-index="${this.currentIndex}"]`);
                    if (currentField) {
                        currentField.classList.add('focus');
                    }
                }
            }

            handleKeydown(e) {
                switch (e.key) {
                    case 'Enter':
                        e.preventDefault();
                        this.checkPassword();
                        break;
                    case 'Escape':
                        e.preventDefault();
                        this.clearAll();
                        break;
                    case 'Backspace':
                        e.preventDefault();
                        this.removeDigit();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        if (this.currentIndex > 0) {
                            this.currentIndex--;
                            this.focusCurrentField();
                        }
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        if (this.currentIndex < this.maxLength) {
                            this.currentIndex++;
                            this.focusCurrentField();
                        }
                        break;
                    default:
                        if (/^[0-9]$/.test(e.key)) {
                            e.preventDefault();
                            this.addDigit(e.key);
                        }
                        break;
                }
            }

            handlePaste(e) {
                e.preventDefault();
                const pastedData = (e.clipboardData || window.clipboardData).getData('text');
                const numbers = pastedData.replace(/\D/g, '').slice(0, this.maxLength);
                
                if (numbers.length === this.maxLength) {
                    this.currentInput = numbers;
                    this.currentIndex = this.maxLength;
                    this.updateDisplay();
                    this.focusCurrentField();
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            new LoginSystem();
        });
    </script>
</body>
</html> 